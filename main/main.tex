\documentclass[11pt,a4paper, 
swedish,english %% Make sure to put the main language last!
]{article}
\pdfoutput=1

%% Andréas's custom package 
%% (Will work for most purposes, but is mainly focused on physics.)
\usepackage{../custom_as}

%% Figures can now be put in a folder: 
\graphicspath{ {figurer/} %{some_folder_name/}
}

%% If you want to change the margins for just the captions
\usepackage[margin=10 pt]{caption}

%% To add todo-notes in the pdf
\usepackage[%disable  %%this will hide all notes
]{todonotes} 

%% Change the margin in the documents
\usepackage[
%            top    = 3cm,              %% top margin
%            bottom = 3cm,              %% bottom margin
%            left   = 3cm, right  = 3cm %% left and right margins
]{geometry}


%% If you want to chage the formating of the section headers
%\renewcommand{\thesection}{...}
\swapcommands{\Lambda}{\varLambda}
\swapcommands{\Omega}{\varOmega}
\swapcommands{\Gamma}{\varGamma}
\newcommand{\Lsq}[1]{\ensuremath{\mathcal{L}^2_{#1}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}%% v v v v v v v v v v v v v v v v v v v v v v v v v v
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% If you want to use an external file for the title page
%\input{titlepages.tex}


%%%%%%%%%%%%%%%%%%%% vvv Internal title page vvv %%%%%%%%%%%%%%%%%%%%%
\begin{titlepage}
\title{\tt Project lambda}
\author{Niklas Renström \and Andréas Sundström}
\date{\today}

\maketitle

%% Page numbering:
%\pagenumbering{roman} %% roman pagenumbering
\thispagestyle{empty} \pagestyle{empty} %% no page numbers 

%% The abstract of the document
\begin{abstract} 


\end{abstract}
\newpage
\tableofcontents
\end{titlepage}

\pagenumbering{arabic}
\setcounter{page}{1}
%%%%%%%%%%%%%%%%%%%% ^^^ Internal title page ^^^ %%%%%%%%%%%%%%%%%%%%%
%% If you want a list of all todos
%\todolist


\section{Introduction}
%\todo[inline]{General intro to hyopthermia and freq dep.}

This project will study the efficacy of ultra-wideband (UWB) hyperthermia treatmants in comparison to narrowband (NB). Previous studies have mostly been conducted using numerical or experimantal methods. In this project however, we intend to investigate this subject from a more theoretical and mathematical stand point. 

There exists a number of uncertainty  principals stating that a function cannot be highly localized in the space and frequency domains at the same time. An electromagnetic field coming from an UWB signal will be less localized in the frequency domain than a NB one and should therefore lead to better localization in the space domain. However, prior studies have found indications that this is not the case and an UWB approach does not significantly improve performance over NB.

This project aims to find some theoretical grounds for the reasons behind this by taking a closer look at relevant uncertainty principles and calculating values for a simplified case of hyperthermia treatment. More specifically, the head and tumour will be regarded as two cocentrical disks

%The goal of this project will be to explain why the Heissenberg inequality breaks down in a scenario like hyperthermia treatment, and to offer some theoretical understanding as to how some NB frequencies still can be focused.

\section{Heisenberg's uncertainty principle and its signifance for Electromagnetic waves}
The Fourier theory states that any function in space can be divided into a linear combination of plane waves 
\begin{equation*}
 f(\vb*x) = \int_{\vb*k}\id^3k \tilde{f}(\vb*k) \ee^{\ii( \vb*k\vdot\vb*x - \omega t)}
\end{equation*}
with different wave-vectors $\vb*k$. %wavelengths and directions of propagations. 
One can speak of different representations in the space ($\vb*x$) domain and the spacial frequency ($\vb*k$) domain respectively, with the Fourier transform as the link between them.

Heisenberg's uncertainty principle, a famous formula in quantum physics states that one cannot perfectly determine both the position and momentum of a free particle in space. This inequality however, is based only on the wave nature of particles and can be seen more as a mathematical inequality on Hilbert spaces than a physical one. As such it also has an equivalent with respect to Fourier transforms which says that the more localized a function is in the space domain the more spread out it must be in the spacial frequency domain.

From Maxwell's equations we know that if an electric field in a lossless media oscillates in time with a certain angular frequency $\omega$ then it  must also oscillate in space with a certain wavelength $\lambda=\sqrt{\epsilon \mu} \omega 2\pi$. Since the wavelength is basically the inverse of the length of the wavvevector $\vb*k$, the Fourier transform would be limited to contain wavevectors with such length. Thus an electric field generated by a NB signal will be highly localized in the frequency domain which should lead to a big spread in the space domain. Therefore an UWB signal would lead to a much better focus which contradicts actual results. We believe that this contradiction is due to a lack of detail in the reasoning and to understand why one must ``put the words into numbers'' and clarify what the uncertainty principle actually says and how it can be applied to the case of hyperthermia.

\subsection{Decomposition of eletromagnetic waves in frequency components}

Due to the linearity of Maxwell's equations, if the signal generating an EM-field varies harmonically in time so will the field,
\begin{equation*}
\vb*E(\vb*x,t)=\vb*E(\vb*x)\cos(\omega t).
\end{equation*}
which allows the use of phasors,
\begin{equation*}
\vb*E(\vb*x,t)=\Re\qty[\vb*E(\vb*x)\ee^{-\ii\omega t}].
\end{equation*}
In a lossless homogeneous media, with this notation, Maxwell's equations lead to the Helmholtz equation
\begin{equation}
  \label{eq:Helmholtz}
  \laplacian  \vb*E + \frac{\omega^2}{v^2}\vb*E=0,
\end{equation} 
where the speed of propagation $v=\frac{1}{\sqrt{\mu \epsilon}}$ has been introduced. This equation has a solution
\begin{equation*}
\vb*E(\vb*x)=\vb*A\ee^{i\vb*k \cdot \vb*x},
\end{equation*}
a plane wave were the wavevector $\vb*k$ is any vector such that $\abs{\vb*k}=k$ and $\vb*A$ is a vector-amplitude $\vb*A=A_X\hat{x}+A_y\hat{y}+A_z\hat{z}$, such that each component corresponds to each component of the  EM-field.
Again, since Maxwell's equations are linear, any sum of such solutions is also a solution and the general solution can be written as
\begin{equation}
  \label{eq:gen_sol}
  \vb*E(\vb*x)=\int_{\abs{\vb*k}=\frac{\omega}{v}}\vb*A(\vb*k)\ee^{\ii\vb*k\cdot\vb*x}\id^3k,
\end{equation}
where the vectoramplitude $\vb*A(\vb*k)$ now represents the amplitude of each wavecomponent $\ee^{\ii\vb*k \cdot \vb*x}$.

The EM-field can also be expanded by its Fourier Transform
\begin{equation}
  \label{eq:f_exp}
  \vb*E(\vb*x)=\frac{1}{2\pi}\int_{\vb*k} \widetilde{\vb*E}(\vb*k) \ee^{\ii(\vb*k\cdot\vb*x - \omega t)}\id^3k.
 \end{equation}


Comparing the Fourier expansion (\ref{eq:f_exp}), an integral over the whole $\vb*k$-space, with the general solution (\ref{eq:gen_sol}), an integral only over the subspace where $\abs{\vb*k}=\frac{\omega}{v}$ one can identify an expression for the Fourier transform $\widetilde{\vb*E}(\vb*k)$ as

\begin{equation}
  \label{eq:f_transf}
  \widetilde{\vb*E}(\vb*k)=2\pi\vb*A(\vb*k)\delta(\abs{\vb*k}-\frac{\omega}{v})=2\pi\vb*A(\theta,\phi)\delta(\abs{\vb*k}-\frac{\omega}{v}).
\end{equation}

Here a $\delta(\abs{\vb*k}-\frac{\omega}{v})$-term has been introduced to display the fact that the Fourier transform $\widetilde{\vb*E}(\vb*k)$ vanishes where $\abs{\vb*k} \neq\frac{\omega}{v}$.
This is further emphasized in the last step where one sees the amplitude $\vb*A$ not as a function of the wavevector $\vb*k$ but as a function of the angles in the $\vb*k$-space $\theta$ and $\phi$.

In short, for each frequency $\omega$ the Fourier transform of the EM-field is concentrated to a sphere shell with radius $\abs{\vb*k}=\frac{\omega}{v}$ and vanishes elsewhere.

\subsection{Heisenberg's inequality}
The common version of Heisenberg's uncertainty principle used in quantum mechanics states that the product of the variance of two observables must be greater than the expected value of their commutator. With the correct interpretations this can be reduced to the following form about vector fields and their Fourier transform cite folland, 
\begin{equation}
\Delta_{\vb*a}f \Delta_{\vb*\alpha} \tilde{f} \geq \frac{9}{4}, \quad \forall \vb*a, \vb*\alpha, \forall f \in \Lsq[\infty],
\end{equation}
where $\Delta_af$ is a measure of how spread out $f$ is around a point $\vb*a$;
\begin{equation}
  \label{eq:spread_def}
\Delta_{\vb*a}f=\frac{\int_{\vb*x}\id^3x\abs{\vb*x-\vb*a}^2\abs{f(\vb*x)}^2}{\int_{\vb*x}\id^3x\abs{f(\vb*x)}^2}.
\end{equation}
The minimum is achieved when $\vb*a$ is the center of mass of $f$ and the measure is then directly analogous to the variance measure of probability theory.

For the EM-field this gives an inequality for each component $E_i$\footnotemark{}
\begin{equation}
  \label{eq:ineq_final}
  \Delta_{\vb*a}E_i\geq \frac{9}{4} \frac{1}{\mathrm{Min}_\alpha\Delta_{\vb*\alpha}\tilde{E_i}}, \quad \forall \vb*a.
\end{equation}
Since the fourier transform of the EM-field is concentrated on a sphere we achieve the minimum spread for $\alpha=0$ and using equations \ref{eq:spread_def} one gets,
$\mathrm{Min}_\alpha\Delta_{\vb*\alpha}\tilde{E_i}=\frac{\omega^2}{v^2}$ and \ref{eq:ineq_final} becomes
\begin{equation}
 \Delta_{\vb*a}E_i\geq \frac{9v^2}{4\omega^2}=\frac{9\lambda^2}{16\pi^2}=\frac{9}{16\pi^2\epsilon\mu\nu^2}.
 \end{equation}

If the variation of $E$ is high it implies that $E$ cannot be highly localized to one small neighbourhood in space, but it does not preclude $E$ from being concentrated in small neighbourhoods of two or more widely spread out points. Therefore, for hyperthermia treatment, the variation measure at best gives a hint on what we want. We could achieve a very high peak in the tumour without violating the inequality as long as a significant part of the EM-field is located outside of the head.
This however is a consequence of the particular form we have stated the uncertainty relation, it does hold that a function cannot be highly localized both in the space and frequency domains but this can be quantified in many different ways, one of which we shall see in the next section.

\footnotetext{The problem of summing the amplitude of the different components $E_i$ to get the final intensity $|E|^2$ will be dealt with later.}

\section{The Slepian-Landau-Pollak uncertainty relations}
In a series of papers from the 60's D. Slepian, H.J. Landau and H.O. Pollak investigated how much energy a frequency-limited function can keep if it is restricted in space. By doing this one can reach an inequality on the form
\begin{equation}
\abs{S}\abs{\Omega} \geq c(\alpha,\beta),
\end{equation}
Where $S$ and $\Omega$ are areas to which a function is restricted to in space respectivley frequency. The constants $\alpha$ and $\beta$ are the fractions of energy that the function contains in these areas. 

In what follows we will show the broad strokes for developing the theory from which the inequality can be extracted. In doing so we will prove the existance of a useful set of functions ${\psi_i}$ who span the room of frequency-limited functions and one of which maximizes the energy retained for a frequency-limited function also limited in the space $S$.

A square-integrable function $f$ of $D$ variables is said to be $\Omega$-limited if it can be represented as a Fourier integral over the bounded region $\Omega$,

\begin{equation}
  f(\vb*x)=\qty(\frac{1}{2\pi})^D\int_\Omega \tilde{f}(\vb*k)\ee^{\ii(\vb*k \cdot \vb*x)} \id^Dk,
\end{equation}
that is, it only contains frequencies in the area $\Omega$.
We define the energy of a function to be
\begin{equation*}
A=\int_{R^D}\abs{f(\vb*x)}^2\id^3x.
\end{equation*}
By Parseval's theorem we get that
\begin{equation*}
A=\int_{R^D}\abs{f(\vb*x)}^2\id^3x=\qty(\frac{1}{2\pi})^D \int_\Omega \abs{\tilde{f}(\vb*k)}^2 \id^Dk.
\end{equation*}
In a bounded region $S$ of the space $R^D$ one gets the total energy
\begin{align*}
  A_S=\int_S\abs{f(\vb*x)}^2\id^Dx&=\int_S\id^Dx \qty(\frac{1}{2\pi})^{2D}\int_\Omega \tilde{f}(\vb*k)\ee^{\ii\vb*k\cdot \vb*x}\id^Dk \int_\Omega \tilde{f}^*(\vb*k')\ee^{-\ii\vb*k'\cdot \vb*x}\id^Dk'\\
 & =\qty (\frac{1}{2\pi})^D \int_\Omega\id^3k\int_\Omega\tilde{f}(\vb*k)\tilde{f}^*(\vb*k')K_s(\vb*k-\vb*k')\id^Dk',
\end{align*}
with the kernel
\begin{equation}
  \label{eq:kernel}
K_s(\vb*k-\vb*k')=\frac{1}{2\pi}^D\int_S\ee^{\ii\vb*x \cdot(\vb*k-\vb*k')}.
\end{equation}
Next if we define an integraloperator $I^{[\Omega S]}$ such that;
\begin{equation}
  \label{eq:int_op}
\qty[I^{[\Omega S]}\phi](\vb*k')=\int_\Omega K_S(\vb*k-\vb*k')\phi(\vb*k)\id^Dk,
\end{equation}
and an inner product on the $\Omega$-space by
\begin{equation}
  \label{eq:in_prod}
   \langle f,g\rangle =\int_\Omega f(\vb*k)g^*(\vb*k)\id^3k,
\end{equation}
the fraction of energy that an $\Omega$-limited function $f$ can have in a region $S$ can be written as
\begin{equation}
  \label{eq:energy_frac_final}
\frac{A_s}{A}=\frac{\int_\Omega\qty[I^{[\Omega S]}\tilde{f}](\vb*k)\tilde{f}^*(\vb*k)\id^Dk}{\int_\Omega \abs{\tilde{f}(\vb*k)}^2 \id^Dk}=\frac{ \langle I\tilde{f}, \tilde{f}\rangle}{\langle \tilde{f}, \tilde{f} \rangle}.
\end{equation}

 In the litterature integral operators of the kind \eqref{eq:int_op} are called Hilbert-Schmidt integral operators if the kernel is square-integrable in $\Omega$, and such an operator is compact. Since the regions $S$ and $\Omega$ are bounded square-integrability holds for the kernel \eqref{eq:kernel} and since it is also complex symmetric with respect to its arguments, $K_s(\vb*k-\vb*k')=K_s^*(\vb*k'-\vb*k)$, the integral operator is self-adjoint with respect to the inner product \eqref{eq:in_prod}. From the Spectral theorem it now follows that the functions fullfilling the eigenvalue equation
\begin{equation}
  \label{eq:eigen}
\qty[I^{[\Omega S]}\psi](\vb*k)=\int_\Omega K_s(\vb*k')\psi(\vb*k') \id^Dk'=\lambda \psi(\vb*k)
\end{equation}
form an orthogonal base for the space $\Omega$ and thus their inverse Fourier transform a base for the space of $\Omega$-limited functions in $R^D$. It also follows that the maximum of equation \eqref{eq:energy_frac_final}, the maximum fraction of energy, equals the largest eigenvalue $\lambda_0$ of equation \eqref{eq:eigen} and the function fulfilling this is the inverse Fourier transform of the coresponding eigenfunction $\psi_0$.

This $\lambda_0$ will be dependent on the size and shape of the areas $S$ and $\Omega$ and will form the base for our inequalities. In the following sections we will calculate these limits for some simple geometries as well as provide ideas for how it can be extended to more complex regions.

\subsection{The disk and the ball}
If $\Omega$ and $S$ are both circular disks with $S$ a scaled version of $\Omega$, $S=c\Omega$, then the eigenvalue equation \eqref{eq:eigen} can be significantly simplified. Through symmetrical arguments Slepian shows in cite that the solutions can be written on the form
\begin{align}
 &\psi_{0,n}(k,\theta)=\frac{\phi_{0,n}(k)}{\sqrt{k}}, \quad &\lambda_{0,n}= ...\gamma \\
  &\psi_{N,n}(k, \theta)=\frac{\phi_{N,n}(k)}{\sqrt{k}}\mqty{\sin(N\theta)\\ \cos(N\theta)} , \quad &\lambda_{N,n}= ... \gamma\\
  &N,n=0,1,\ldots
\end{align}
where $\phi$ and $\gamma$ are solutions to a simpler eigenvalue equation
\begin{equation}
  \label{eq:Bessel_int}
\gamma\phi(k)=\int_0^1 J_N(ckk')\sqrt{ckk'}\phi(k')\id k', \quad 0\leq k' \leq 1.
\end{equation}

%Further he shows that these $\phi$ also satisfy the differential equation
%\begin{equation}
%  \label{eq:Bessel_diff}
%(1-k^2)\dv[2]{\phi}{k}-2k\dv{\phi}{k} +\qty(\frac{\frac{1}{4}-N^2}{k^2}+\xi)=0.
%\end{equation}

Using surface harmonics he then continues to show that similiar formulas hold in higher dimensions D>2
\begin{align}
  &\psi_{0,n}(k,\theta)=k^{-(D-1)/2}\phi_{0,n}(k)S_N^l, \quad \lambda_{0,n}= ...\gamma \\
  &l= 1,2, \ldots , h(N,D), \quad N,n=0,1, \ldots,
\end{align}
where $\phi$ and $\gamma$ are solutions to an equation identical to \eqref{eq:Bessel_int} except that $N$ has to be replaced by $N+\frac{D-2}{2}$. 

In the paper from 1964 cite Slepian proves that the $\phi$'s of \eqref{eq:Bessel_int} also satisfy a differential equation and with this he managed to numerically calculate values for $\lambda$ and $\psi$ for different values of $c$. However, with significantly improved computer technology, we chose to work directly with the integral equations \eqref{eq:eigen} and \eqref{eq:Bessel_int} which can also be generalized more easily.
  




\subsection{Finite thickness circle ring in the frequency domain (2D)}
So far we have looked at areas in the space and frequency domains
which have the same shape, filled discs or spheres, but are scaled
versions of each other ($S=c\Omega$). This does however forces us to
include frequencies all the way down to 0, which is not an ideal
description of a real hyperthermia system -- perhaps operating in the
range from few hundered MHz up to a couple of GHz.

We first need to define the areas $S$ and $\Omega$ in the space and
frequency domain respectively. For the space domain we still want a
filed region without a gap in the center, but for the frequency domain
we want to exclude the center part of the region. Let $S$ be a filled
circle disc of radius $R$, and $\Omega$ be the finite thickness circle
ring with outer radius $\Gamma$ and inner radius $q\Gamma$, $0\le q<1$.

\subsubsection{Slepian's method using Fourier transforms}
The methodology used here is a direct translation of the ones used in
\cite{PSWF-I_1961} and \cite{PSWF-IV_1964} to $S$ and $\Omega$.


From the definition of the kernel $K_s$ in eqn. (6) in
\cite{PSWF-IV_1964}, we get 
\begin{equation}
\begin{aligned}
K_S(\vb*k-\vb*k') =& (2\pi)^{-2}
\oldint_S \rd^2r \ee^{\ii\vb*r\vdot\Delta\vb*k}\\
=& (2\pi)^{-2}
\int_0^{2\pi}\rd\theta \int_0^{R} \rd{r}\,r
 \ee^{\ii\, r\Delta{k}\,\cos\theta},
\end{aligned}
\end{equation}
where $\Delta{k} = \abs{\Delta\vb*k} = \abs{\vb*k-\vb*k'}$. To get to
the second step here, choose the integration axes so that $\Delta{k}$
lies on the $\theta=0$ axis and thus
$\vb*r\vdot\Delta\vb*k=r\Delta{k}\,\cos\theta$;
this can be done since, for the sake of the integration
$\Delta{\vb*k}$ can be viewed as a constant. Next we use the usual
Bessel function expansion \cite[formula 8.551.4b]{Gradshteyn-Ryzhik}
\begin{equation}
\ee^{\ii z\cos\theta} = \sum_{m=-\infty}^\infty
\ii^mJ_m(z)\ee^{\ii m\theta}
\end{equation}
to write 
\begin{equation}
\begin{aligned}
K_S(\vb*k-\vb*k') =& (2\pi)^{-2}
\sum_{m=-\infty}^\infty \ii^m
\int_0^{2\pi}\rd\theta\, \ee^{\ii m\theta}
\int_0^{R} \rd{r}\,r J_m(r\Delta{k}).
\end{aligned}
\end{equation}
The $\theta$ integral is zero for all $m\neq0$ and $2\pi$ for $m=0$;
to solve the $r$ integral we use 
\cite[formula~8.472.3]{Gradshteyn-Ryzhik} 
\begin{equation}
\frac{1}{z}\dv{z}\qty[zJ_1(z)] = J_0(z).
\end{equation}
Together this leads to
\begin{equation}
\begin{aligned}
K_S(\vb*k-\vb*k') =& (2\pi)^{-2}
\,(2\pi)\,\frac{1}{(\Delta{k})^2}
\int_0^{R\Delta{k}} \rd{z}\,z\, J_0(z)\\
=& (2\pi)^{-1} \frac{1}{(\Delta{k})^2}
\Big[zJ_1(z)\Big]_{z=0}^{R\Delta k}
&=(2\pi)^{-1} \frac{R}{\Delta{k}} J_1(R\Delta{k}).
\end{aligned}
\end{equation}

The next step is to manipulate the actual integral eigenvalue equation
\todo{ref to some eqn. before}
\begin{equation}
\lambda \psi(\vb*k) = \oldint_\Omega \rd^2k'\,
%(2\pi)^{-1} \frac{R}{\Delta{k}} J_1(R\Delta{k}) 
K_S(\vb*k-\vb*k')\psi(\vb*k')
\end{equation}
which by polar coordiane substitution becomes
\begin{equation}\label{eq:eigint-pol}
\lambda\psi(k, \theta) =
\int_{q\Gamma}^\Gamma\rd{k'}\,k'
\int_{0}^{2\pi}\rd\theta'\,\frac{R}{2\pi}
\frac{J_1(R\Delta{k})}{\Delta{k}} \psi(k',\theta')
\end{equation}
We note that, by the law of cosines, 
$\Delta{k}=\abs{\vb*k-\vb*k'}=\sqrt{k^2+{k'}^2-2kk'\cos(\Delta\theta)}$, 
where $k=\abs{\vb*k}$, $k'=\abs{\vb*k'}$ and
$\Delta\theta=\theta-\theta'$ is the angle between $\vb*k$ and
$\vb*k'$. This means that 
\begin{equation}\label{eq:KS-long}
K_S(k, k', \Delta\theta) = \frac{R}{2\pi}\,
\frac{J_1\qty(R\sqrt{k^2+{k'}^2-2kk'\cos(\Delta\theta)})}
{\sqrt{k^2+{k'}^2-2kk'\cos(\Delta\theta)}}
\end{equation}
is $2\pi$-periodic in $\Delta\theta$, and thus has a Fourier series expansion 
\begin{equation} \label{eq:KS-FS}
K_S(k, k', \Delta\theta)  
=\sum_{n=-\infty}^\infty a_{n}(k, k')\, \ee^{\ii n\Delta\theta}
=\sum_{n=-\infty}^\infty a_{n}(k, k')\, \ee^{\ii n\theta}\ee^{-\ii n\theta'}
\end{equation}
We also know that the eigenfunctions, $\psi$, has to be periodic in
$\theta$ since the kernel is periodic in both $\theta$ and
$\theta'$. Therefore 
\begin{equation}\label{eq:psi-FS}
\psi(k, \theta) = \sum_{m=-\infty}^\infty b_m(k)\ee^{\ii m\theta}
\end{equation}
also has a Fourier series. 

With the two results, \eqref{eq:KS-FS} and \eqref{eq:psi-FS}, the
eigenvalue equation \eqref{eq:eigint-pol} can be written as
\begin{equation}
\begin{aligned}
\lambda\sum_{l=-\infty}^\infty b_l(k)\ee^{\ii l\theta}
=& \int_{q\Gamma}^\Gamma\rd{k'}\,k'\int_{0}^{2\pi}\rd\theta'\,
\sum_{n=-\infty}^\infty a_n(k)\ee^{\ii n\theta}\ee^{-\ii n\theta'}
\sum_{m=-\infty}^\infty b_m(k)\ee^{\ii m\theta'}\\
=& \sum_{n=-\infty}^\infty \ee^{\ii n\theta} \sum_{m=-\infty}^\infty 
\int_{q\Gamma}^\Gamma\rd{k'}\,k' a_n(k') b_m(k')
\int_{0}^{2\pi}\rd\theta'\,
\ee^{\ii (m-n)\theta'}.
\end{aligned}
\end{equation}
Like before the $\theta'$ integral is only non-zero when $m-n=0$ and
then the integral is just $2\pi$. We now get
\begin{equation}
\lambda\sum_{l=-\infty}^\infty b_l(k)\ee^{\ii l\theta}
= \sum_{n=-\infty}^\infty \ee^{\ii n\theta} 
\int_{q\Gamma}^\Gamma\rd{k'}\,k' a_n(k') b_n(k'),
\end{equation}
or more simply
\begin{equation}
\lambda_n b_n(k) = \int_{q\Gamma}^\Gamma\rd{k'}\,k' a_n(k') b_n(k').
\end{equation}

The problem however, with this method is that the kernel Fourier
coefficients, $a_n(k, k')$, cannot be calculated analytically. This
makes for some very costly numerical calculations if $a_n(k, k')$
has to be calculated numerically for each pair of $k$ and $k'$.


\subsubsection{A similar method using Hankel transforms}
%As a direct translation Slepian's method yielded a numerically 
%expensive method, we also looked 
Slepian's method looked at the Fourier representation of the EM-field and looked at how a function limited in the Fourier ($\vb*k$) space behaved in the $\vb*x$-space. Although we were able to extract useful information it required alot of manipulations of the formulas and also in the end some costly numerical calculations. The reason behind this is that the Fourier ($\vb*k$) space speaks of plane waves which form solutions to the wave equation in cartesian coordinates while we were interested in geometries best described by polar coordinates. In an alternative approach we therefore started in a polar description, developed a base for the EM-field and used this to maximize a quotient of the form \eqref{eq:energy_frac_final}.

In polar coordinates the Helmholtz equation \eqref{eq:Helmholtz} takes the form
\begin{equation}
\label{eq:Helmholtz_polar}
(\pdv[2]{r}+\frac{1}{r}\pdv{r}+\frac{1}{r^2}\pdv[2]{\theta})E+k^2E=0,
\end{equation}
with $k^2=\omega^2\mu\epsilon$. For a separable function $\phi(r,\theta)=R(r)\Theta(\theta)$ the equation can be separated into two
\begin{align}
&n^2\Theta-\dv[2]{\Theta}{\theta}=0 \label{eq:angular} \\
&r^2\dv[2]{R}{r}+r\dv{R}{r}+(k^2r^2-n^2)R=0 \label{eq:radial}.
\end{align}
Equation \eqref{eq:angular} has a solution of plane waves
\begin{equation}
\label{eq:sol_angular}
\Theta(\theta)=c_n\ee^{\ii n \theta}.
\end{equation}
Since $\Theta$ must be periodic over $2\pi$, $n$ must be an integer which motivates the name $n^2$ for the previous arbitrary constant. We notice that these form a base for functions defined on the interval$[0,2\pi)$
The radial equation \eqref{eq:radial} on the other hand has a solution of Bessel functions
\begin{equation}
\label{eq:sol_radial}
R(r)=a_nJ_{n}(kr)+b_nN_{n}(kr).
\end{equation}
These functions form a base for functions defined on $[0,\infty)$ but the second kind of Bessel function $N_n$  cannot represent any physical function since they have a singularity in 0 and will therefore be disregarded.
The final solution to \eqref{eq:Helmholtz_polar} can now be written as
\begin{equation*}
\phi_n(r,\theta)=a_nJ_n(kr)\ee^{\ii n \theta}.
\end{equation*}
Since the $r$ and $\theta$-components each form a base for their respective intervals an arbitrary function satisfying Helmholtz equation can be written as a sum of these
\begin{equation}
E(r,\theta)=\sum_{n=-\infty}^{\infty} a_nJ_n(kr)\ee^{\ii n \theta}.
\end{equation}

The Helmholtz equation \eqref{eq:Helmholtz} is valid for a given frequency $\omega$. To get the EM-field of many different frequency components one has to sum over all of them, or in the continous limit integrate. To integrate over $\omega$ is the same as integrating over $k$ which corresponds to the radius in the Fourier space. To get a direct analog to the circle rings previously discussed we can therefore let $k$ go from $q\Gamma$ to $\Gamma$ and obtain a general EM-field:
\begin{equation}
\label{eq:polar_wave_general}
E(r,\theta)=\int_{q\Gamma}^\Gamma \id k \sum_{n=-\infty}^{\infty} a_n(k) J_n(kr)\ee^{\ii n \theta}
=\sum_{n=-\infty}^{\infty} \int_{q\Gamma}^\Gamma \id k kb_n(k) J_n(kr)\ee^{\ii n \theta},
\end{equation}
where in the last step $a_n(k)$ has been replaced with $kb_n(k)$ for later convenience.
This expression can now be used to calculate the energy in a disk $S$ following a similar procedure to Slepian's method
\begin{equation}
  \label{eq:energy_bessel}
\begin{aligned}
\int_S \id^2x \abs{E}^2&= \int_S \int_{q\Gamma}^\Gamma \id k \sum_{n= -\infty}^{\infty} kb_n(k) J_n(kr)\ee^{\ii n \theta} \int_{q\Gamma}^\Gamma \id k' \sum_{m= -\infty}^{\infty} \frac{b_m^*(k')}{k'} J_n(k'r)\ee^{-\ii m \theta}\\
&=\int_{q\Gamma}^\Gamma \id k \int_{q\Gamma}^\Gamma \id k' \sum_{n= -\infty}^{\infty} \sum_{m= -\infty}^{\infty} \int_{r=0}^{R_s} \id r r J_n(kr)J_m(k'r)\underbrace{\int_{\theta=0}^{2\pi} \id \theta \ee^{\ii (n-m) \theta}}_{=2\pi \delta_{mn}}\\
&=2\pi \sum_{n=-\infty}^{\infty} \int_{q\Gamma}^\Gamma \id k \int_{q\Gamma}^\Gamma \id k'  kb_n(k) k'b_n^*(k') \underbrace{\int_{r=0}^{R_s} \id r r J_n(kr) J_n(k'r)}_{K_s^n(k,k')}\\
&=2\pi \sum_{n=-\infty}^{\infty} \int_{q\Gamma}^\Gamma \id k \int_{q\Gamma}^\Gamma \id k'  kb_n(k) k'b_n^*(k') K_S^n(k,k')\\
&=2\pi \sum_{n=-\infty}^{\infty} \langle [I_S^nb_n],b_n \rangle,
\end{aligned}
\end{equation}
where we in the last step defined the integral operator
\begin{equation}
  \label{eq:int_op_bessel}
[I_S^nb_n](k'):=\int_{q\Gamma}^\Gamma \id k k K_S^n(k,k')b_n(k),
\end{equation}
and the inner product
\begin{equation}
  \label{eq:in_prod_bessel}
\langle u,v \rangle := \int_{q\Gamma}^\Gamma \id k k u(k), v(k).
\end{equation}

If we let the radius $R_S$ of the disk $S$ tend to infinity the kernel $K_S$ tends to a $\delta$-function in $(k-k')$ divided by $k$;
\begin{equation*}
K_S(k,k')  := \int_{r=0}^{R_s} \id r r J_n(kr) J_n(k'r) \to \frac{\delta(k-k')}{k}, R_S \to \infty.
  \end{equation*}
This implies that the integral operator \ref{eq:int_op_bessel} tends to the identity operator $\mathbb{I}$;
\begin{equation*}
  \begin{aligned}
    [I_S^nb_n](k')&:=\int_{q\Gamma}^\Gamma \id k k K_S^n(k,k')b_n(k) \to \int_{q\Gamma}^\Gamma \id k k \frac{\delta(k-k')}{k}b_n(k)
    =b_n(k') \qc R_S \to \infty \forall b_n(k)\\
  &\implies I_S^n \to \mathbb{I}, R_S \to \infty
   \end{aligned}
\end{equation*}

Equation \eqref{eq:energy_bessel} now implies that the fraction of energy one can obtain in a disk of radius $R_S$ becomes the a fraction of sums
\begin{equation}
  \label{eq:energy_frac_bessel}
\frac{\int_S \id^2x \abs{E}^2}{\int_{\mathbb{R}^2} \id^2x \abs{E}^2}=\frac{\sum_{n=-\infty}^{\infty} \langle [I_S^nb_n],b_n \rangle}{\sum_{m=-\infty}^{\infty} \langle b_m,b_m \rangle},
\end{equation}
Since a scaling of the $b_n$:s will not affect the fraction we can
always normalize them so that $\sum_{n=-\infty}^{\infty} \langle b_n, b_n \rangle=1$, which is equivalent to normalize the EM-field.
Now the maximum of \eqref{eq:energy_frac_bessel} can be proven to be the largest eigenvalue to the family of operators $\{I_n\}$;
\begin{equation*}
  \text{max}_{b_n} \sum_{n=-\infty}^{\infty} \langle [I_S^nb_n],b_n \rangle
  \leq \sum_{n=-\infty}^{\infty} \text{max}_{b_n}\langle [I_S^nb_n],b_n \rangle,
  \end{equation*}
since $I_S$ is hermitian under the scalar product \ref{eq:in_prod_bessel} this is limited by
\begin{equation*}
  \sum_{n=-\infty}^{\infty}\lambda_n \langle b_n, b_n \rangle \leq \lambda_{\text{max}}\sum_{n=-\infty}^{\infty}\langle b_n, b_n\rangle=\lambda_{\text{max}},
\end{equation*}
where $\lambda_n$ denotes the largest eigenvalue of $I_S^n$ and $\lambda$_{max} the largest of these.
If we choose the $b_n$:s so that
\begin{equation*}
  b_n(k)
  =\begin{cases} &\phi_n \qc \lambda_n=\lambda_{\text{max}}  \\
  &0 \qc \text{else}
  \end{cases}
\end{equation*}
we obtain an equality which proves the statement.
  




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical implementation of the 
Landau-Pollack-Slepian Theory}
\newcommand{\varD}{\ensuremath{\mathcal{D}}}

In the previous section we have been occupied by integral eigenvalue
equations of the form
\begin{equation} %\label{eq:int-eig}
\lambda E(k) 
= \oldint_{\Omega} \rd^D{k}\, K(k, k') E(k')
\qcomma k, k'\in\Omega.
\end{equation}
We have also put down some work to reduce higher-dimensional
integrals to one-dimensional ones
\begin{equation} \label{eq:int-eig}
\lambda \psi(k) 
= \oldint_{I} \rd{k}\, K(k, k') \psi(k'),
\end{equation}
where the integration is now over some interval 
$I=[\alpha, \beta]$. This was done so that the numerical method
presented here could be applied. 


\subsection{Discretization of the integral equation}
Let's discretize the integral according to
\begin{equation} \label{eq:inttosum}
\begin{aligned}
\oldint_I\rd{k} &\to \sum_{n=1}^N\Delta{k}
=\frac{\abs{I}}{N} \sum_{n=1}^N,\\
\psi(k) \to \psi_n = \psi(k_n) &\qcomma
K(k, k') \to K_{m, n} = K(k_m, k_n),
\end{aligned}
\end{equation}
where $\abs{I}=\beta-\alpha$ is the size of the interval $I$.
With these discretizations, \eqref{eq:int-eig} discretizes to
\begin{equation}
\lambda\Psi_m = \frac{\abs{I}}{N} \sum_{n=1}^N K_{m, n} \Psi_n
\end{equation}
which is just a matrix eigenvalue equation
\begin{equation} \label{eq:mtx-eig}
\Lambda \Psi = \mathsf{K}\Psi,
\end{equation}
where $\Lambda = N\lambda/\abs{I}$ and $\mathsf{K}$ is the $N\times N$ matrix
whose element $(m, n)$ is $K_{m, n}$. From here, there are many high
performance linear algebra libraries to find the eigenvalues and
eigenvector to \eqref{eq:mtx-eig} numerically. 

%\subsubsection{Symmetrization }
We can also note that some effort was put into making the integral
kernel symmetric. This not only has the effect of guarateeing that the
eigenvectors of different eigenvalues will be orthogonal, but is also
beneficial to most numerical methods to find eigenvalues. 


% \subsubsection{Physical interpretation}
% An interesting physical interpretation of the discretization is that
% the operation \eqref{eq:inttosum} can be viewed as introducing
% \begin{equation}
% \Delta{k}\qty[\delta(k-k_0) + \delta(k-k_1) +\ldots+\delta(k-k_N)]
% \end{equation}
% into the integral, and effectively limiting the frequencydomain
% $\Omega$ to the dicrete frequencies $k_n$. 

% This idea could possibly be more cloesly related to reality, where the
% differnt antennas only transmitts in certain dicrete frequencies. And
% thus the discretized eigenvalue problem gives the theoretical maximum
% energy in a bounded region in space from a signal restriced to the
% chosen frequencies. 
% It is however worth pointing out that this result has only been proven
% for the 1D case\cite{PSWF-V_1978}, but there is no reason to believ
% that the discetized version cannot be extended to higher dimension
% like in the continuous case. 








%%%%%%%%%%%%%%%%%%%%%%%%%% The bibliography %%%%%%%%%%%%%%%%%%%%%%%%%%
%\newpage
%% This bibliography ueses BibTeX
\bibliographystyle{ieeetr}
\bibliography{references}%requires a file named 'references.bib'
%% Citations are as usual: \cite{example_article}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Appendices %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage %% on a new page 
\appendix  %% This will change the page numbering to A1, A2, A3, ...;
           %% and also change the sections to A, A.1, ...; B, B.1, ...


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}%% ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%  Some (useful) templates


%% På svenska ska citattecknet vara samma i både början och slut.
%% Använd två apostrofer: ''.


%% Including PDF-documents
\includepdf[pages={1-}]{filnamn.pdf} % NO blank spaces in the file name

%% Figures (pdf, png, jpg, ...)
\begin{figure}\centering
\centerline{ % centers figures larges than 1\textwidth
\includegraphics[width=.8\textwidth]{file_name.pdf}
}
\caption{}
\label{fig:}
\end{figure}

%% Figures from xfig's "Combined PDF/LaTeX"
\begin{figure}\centering
\resizebox{.8\textwidth}{!}{\input{file_name.pdf_t}}
\caption{}
\label{fig:}
\end{figure}


%% If you want to add something to the ToC
%% (Without having an actual header in the text.)
\stepcounter{section} %For example a 'section'
\addcontentsline{toc}{section}{\Alph{section}\hspace{8 pt}Labblogg} 

